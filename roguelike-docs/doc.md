# Roguelike
## Общее описание
Данное приложение является консольной пошаговой RPG-игрой. Основной целью игры является гринд, т.е. прокачка персонажа.
#### Базовые требования
* Кроссплатформенность - для реализации данного требования используем Java
* Низкие системные требования - минимальная версия игры должна поддерживаться большинством устройств, в том числе и с низкими техническими характеристиками. Поэтому принято решение сделать игру консольной и пошаговой.
* Интуитивное управление - использование сложных команд или комбинаций клавиш повышает порог вхождения в игру, уменьшая охват аудитории. Для реализации данного требования предлагается использовать единичные клавиши на клавиатуре.

## Правила игры

### Общие правила
Игровой мир представляет собой **игровое поле**, состоящее из **клеток** в декартовой системе координат, на котором обитают **сущности**. У каждой сущности есть **состояние**, **характеристики**, имя и **уровень**. Помимо этого, на сущность действуют определенные **эффекты**, которые меняют характеристики и состояние сущности. Так же сущность может иметь **экипировку**, которая так же влияет на сущность, как и эффекты.
Жизнь в игровом мире происходит по **шагам**. Монстры и игрок раз в несколько шагов (количество определяется их состоянием) совершают **ход**, который заключается в перемещении сущности в одну из четырех сторон света или нападении на сущность, стоящую рядом.

### Сущности
* Монстр - злобное существо, пришедшее в этот мир с единственной целью - убить игрока. Управляется внутренним ИИ.
* Игрок - герой, который старается выжить среди ужасных монстров. Повышает уровень в зависимости от количества убитых им монстров. Помимо экипировки, так же имеет инвентарь, в который может складывать предметы про запас.
* Препятствие - препятствия могут быть двух типов - смертные (могут содержать сокровища) и бессмертные (ограничивают мир).
* Дроп - один или несколько предметов. Может появиться на карте когда погибает монстр или уничтожаемое препятствие.

### Состояние сущности
* Здоровье - суммарное количество маны у сущности. Не может быть меньше 0. При значении 0 сущность считается мертвой.
* Регенерация здоровья - количество здоровья, восстанавливаемого за один шаг. Не может быть меньше 0.
* Мана - суммарное количество маны у сущности. Не может быть меньше 0. При значении 0 сущность не может наносить магические удары. На каждую единицу нанесенного магического урона тратится одна единица маны.
* Регенерация маны - количество маны, восстанавливаемой за один шаг. Не может быть меньше 0.
* Магический урон - количество урона, наносимого магическими ударами. Не может быть меньше 0.
* Физический урон - количество урона, наносимого простыми ударами. Не может быть меньше 0.
* Заморожен - указывает на то, может ли сущность совершать действия
* Нем - указывает на то, может ли сущность использовать ману

### Характеристики
* Сила - определяет силу физических ударов.
* Ловкость - определяет вероятность уклониться от простых ударов или попасть простым ударом по врагу. Кроме того уменьшает медлительность персонажа.
* Выносливость - увеличивает максимальный запас здоровья и регенерацию.
* Интеллект - определяет силу магических ударов.
* Мудрость - увеличивает запас маны и ее регенерацию.
* Удача - определяет вероятность уклониться от простых или магических ударов или попасть простым или магическим ударом по врагу
* Количество рук - количество доступных рук. Чем больше рук - тем больше оружия и наручной брони может использовать сущность одновременно.
* Количество ног - количество доступных ног. Чем больше ног - тем больше наножной брони может использовать сущность одновременно.
* Количество голов - количество доступных голов. Чем больше голов - тем больше головных уборов может использовать сущность одновременно.
* Медлительность - раз в сколько шагов сущность может совершить ход.

### Эффекты
Каждый эффект имеет количество времени, за которое он прекращает действовать. Если тот же самый эффект был применен до того, как он закончил действовать на сущность, то действие эффекта суммируется до тех пор, пока его первая версия не прекратит действовать.
Уровень эффекта влияет на его силу и длительность.
Эффекты бывают нескольких типов:
* Отключение - накладывает немоту и/или заморозку.
* Ожоги - наносит урон с течением времени.
* Магические ожоги - наносит урон мане.
* Регенерация - увеличивает регенерацию здоровья/маны.
* Характеристики - меняет основные характеристики (кроме количества конечностей).
* Воздействие на тело - меняет количество конечностей.


### Экипировка
Сущность не может носить экипировку, которая выше нее по уровню.
Свойства экипировки так же описываются эффектами, однако эти эффекты не имеют ограничения по времени и не отображаются вместе с временными эффектами. При расчетах силы экипировки длительность этих эффектов задается константой.
Реальная сила предметов может не соответствовать заявленному уровню предмета, однако границы этого несоответствия задаются уровнем предмета. Также предмет может иметь один или несколько модификаторов:
* Кровососущий - эффект "ожог". Увеличивает сумму уровней эффектов. Редкий модификатор.
* Грубая сила - эффект "немота". Удваивает сумму уровней. 
* Безногим - уменьшает количество конечностей, взамен увеличивает силу предмета в зависимости от количества потерянных конечностей. Крайне редкий модификатор. 
* Тяжелый - увеличивает медлительность и уменьшает ловкость персонажа. Взамен значительно увеличивает характеристики предмета. Встречается часто.
Оружие, помимо положительных эффектов, так же накладывает негативные эффекты на врагов. Правила подсчета уровней эффектов такие же, как и для положительных эффектов, но с учетом длительности.

### Очередность хода
* Сущности регенерируют
* Пересчитываются текущие характеристики сущностей
* Пересчитывается текущее состояние сущностей
* Убираются умершие сущности
* Монстры совершают ход
* Игрок совершает ход
* Игра сохраняется
Во время хода одна сущность может атаковать другую, если пойдет в ее направлении.

### Бой
Нападающая сущность бьет атакуемую сущность простым и магическим (если нет немоты и достаточно маны) ударами. Если удар достиг цели, то атакуемая сущность теряет часть очков здоровья. Если здоровье стало меньше или равно нулю, то атакуемый погибает.
Если у нападающего не хватает маны для нанесения магического удара в полном объеме, то наносится только часть урона, равная количеству оставшейся маны.
У атакующего есть возможность уклониться от ударов:
* Вероятность попадания простого удара зависит от ловкости и удачи сражающихся.
* Вероятность попадания магического удара зависит только от удачи сражающихся.

### Генерация предметов и опыт персонажа
После смерти монстра из него может с определенной вероятностью выпасть один или несколько предметов.
Уровень предмета зависит от уровня сущности, из которой он выпал, но не обязан с ним совпадать.
После того, как в мире умрет несколько монстров, сложность игры, оцениваемая **уровнем мира**, повышается. Вместе с ним повышается и уровень персонажей игроков.
С ростом уровня, количество требуемого опыта для повышения растет в зависимости от уровня, за смерть одного монстра дается опыт, зависящий от уровня монстра. Новые монстры, появляющиеся в мире, имеют уровень, равный текущему уровню мира.

### Базовые значения характеристик и их изменение
Все характеристики игрока изначально равны 10 и уровень равный 1. Игрок имеет две руки, две ноги и одну голову. Медлительность игрока равна 10.
При повышении уровня персонаж получает +1 ко всем базовым характеристикам за исключением количества конечностей и медлительности.
Все характеристики монстров изначально равны 5. С уровнем монстр получает несколько очков характеристик, которые распределяются случайно. Монстр первого уровня имеет 2 ноги и 1 голову, однако на более высоких уровнях монстры получают дополнительные конечности

## Архитектура
Основные модули:
* Commons - общие утилиты. Содержит интерфейс savable, который должен уметь сохраняться и загружаться.
* Game-model - описание данных всего, что существует в игровом мире, а так же их генераторов. Предполагается, что для создания сущностей будут использоваться фабрики, а для взаимодействия с ними - имплементации визиторов.
* Game-logic - логика существования игрового мира. Содержит ИИ для монстров, а так же основной класс игры - GameExecutor. Его задача - контролировать игровой процесс. 
* Ui-common - общее описание пользовательского интерфейса. Содержит базовые классы для реализации UI.
* Console-ui - имплементация UI для консоли. Так же реализует onPLayerAction.

![architecture](https://github.com/ArgentumWalker/SD-course/raw/hw07/roguelike-docs/GameArchitecture.png)

## Сценарии использования
### Лолер
Персонаж низкого уровня, игрок только знакомится с игрой. Самое интересное для игрока - то, на чем он сфокусирован - убийство монстров.
Игрок старается убить как можно больше монстров, при этом не сильно задумываясь о том, чтобы собирать наиболее выгодную экипировку для персонажа.
На начальных уровнях игроку будет просто, т.к. его характеристики значительно превосходят характеристики монстров. Однако с ростом уровня у игрока начнут возникать сложности из-за неоптимальности экипировки.
Игроку предстоит научиться подбирать оптимальную экипировку для сражения с конкретным монстром, чтобы и дальше успешно убивать их.

### Кекер
Опытный игрок, играющий на высоких уровнях. Этот игрок больше всего заинтересован в росте уровня персонажа и делает все возможное, чтобы это произошло.
При этом игрок понимает, что с ростом уровня растет и сила врагов, а это значит, что ему нужно подбирать все более хорошую экипировку, поэтому он долгое время проводит за рассчетом плюсов и минусов брони и оружия для достижения максимальной эффективности.

### Рофлер
Игрок - коллекционер. Его не интересуют монстры и уровни. Объектом его интереса являются редкие и необычные предметы.
Для получения все новых и новых предметов Рофлеру нужно тратить все больше усилий на то, чтобы получать новые предметы, однако с ростом уровня растет и сила получаемых предметов, что подогревает интерес игрока.

## ИИ монстров
У монстра есть два состояния - блуждание и нападение. Переход между этими фазами осуществляется при попадании персонажа игрока в определенную область рядом с монстром.
В состоянии блуждания монстр свободно перемещается по местности, совершая случайные перемещения.
В состоянии нападения монстр стремится сблизиться с игроком и нанести ему как можно больше урона.

## Генерация уровня
Для генерации уровня предлагается использовать модификацию алгоритма Sidewinder, который должен учитывать, что коридоры могут быть разной ширины, а препятствия на карте так же имеют размер.

## Зависимости
* Zercon - библиотека для консольных приложений
* JUnit - unit-тестирование
